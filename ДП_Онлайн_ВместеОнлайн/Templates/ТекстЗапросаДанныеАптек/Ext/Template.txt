ВЫБРАТЬ
	ЗначенияСвойствОбъектов.Объект КАК АптекаСсыкла,
	ВЫБОР
		КОГДА ЗначенияСвойствОбъектов.Свойство.Код = "Завед"
			ТОГДА Пользователь.Наименование
	КОНЕЦ КАК АптекаЗаведующая,
	ВЫБОР
		КОГДА ЗначенияСвойствОбъектов.Свойство.Код = "ВремяРаботы"
			ТОГДА ЗначенияСвойствОбъектов.Значение
	КОНЕЦ КАК АптекаВремяРаботы
ПОМЕСТИТЬ ВТ_ДопРеквизиты
ИЗ
	РегистрСведений.ЗначенияСвойствОбъектов КАК ЗначенияСвойствОбъектов
		ЛЕВОЕ СОЕДИНЕНИЕ Справочник.Пользователи КАК Пользователь
		ПО ЗначенияСвойствОбъектов.Значение = Пользователь.Ссылка 
ГДЕ
	ТИПЗНАЧЕНИЯ(ЗначенияСвойствОбъектов.Объект) = ТИП(Справочник.Фирмы)
	И НЕ ЗначенияСвойствОбъектов.Объект.ПометкаУдаления
	И (ЗначенияСвойствОбъектов.Свойство.Код = "Завед"
			ИЛИ ЗначенияСвойствОбъектов.Свойство.Код = "ВремяРаботы")
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ДопРеквизитыЗаведующая.АптекаСсыкла КАК АптекаСсыкла,
	ДопРеквизитыЗаведующая.АптекаЗаведующая КАК АптекаЗаведующая,
	ДопРеквизитыВремяРаботы.АптекаВремяРаботы КАК АптекаВремяРаботы
ПОМЕСТИТЬ ВТ_Реквизиты
ИЗ
	(ВЫБРАТЬ
		ДопРеквизиты.АптекаСсыкла КАК АптекаСсыкла,
		ДопРеквизиты.АптекаЗаведующая КАК АптекаЗаведующая
	ИЗ
		ВТ_ДопРеквизиты КАК ДопРеквизиты
	ГДЕ
		НЕ ДопРеквизиты.АптекаЗаведующая ЕСТЬ NULL) КАК ДопРеквизитыЗаведующая
		ЛЕВОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ
			ДопРеквизиты.АптекаСсыкла КАК АптекаСсыкла,
			ДопРеквизиты.АптекаВремяРаботы КАК АптекаВремяРаботы
		ИЗ
			ВТ_ДопРеквизиты КАК ДопРеквизиты
		ГДЕ
			НЕ ДопРеквизиты.АптекаВремяРаботы ЕСТЬ NULL) КАК ДопРеквизитыВремяРаботы
		ПО ДопРеквизитыЗаведующая.АптекаСсыкла = ДопРеквизитыВремяРаботы.АптекаСсыкла
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	Фирмы.Ссылка КАК АптекаСсылка,	
	Фирмы.Наименование КАК АптекаНаименование,
	Фирмы.ПрефиксШКПартии КАК НомерАптеки,
	Фирмы.Код КАК АптекаКод,
	Регионы.Наименование КАК РегионНаименование,
	ЧастиРегионов.Наименование КАК ЧастиРегионовНаименование,
	ВЫРАЗИТЬ(Фирмы.ФактАдрес КАК СТРОКА(300)) КАК АптекаАдрес,
	ВЫРАЗИТЬ(Фирмы.Телефон КАК СТРОКА(100)) КАК АптекаТелефон,
	Бренды.Наименование КАК БрендНаименование,
	ЮрЛица.Наименование КАК ФирмаНаименование,
	ЮрЛица.ИНН КАК ФирмаИНН,
	ДопРеквизиты.АптекаЗаведующая КАК АптекаЗаведующая,
	ДопРеквизиты.АптекаВремяРаботы КАК АптекаВремяРаботы,
	РабочиеМеста.Ссылка КАК РабочееМестоСсылка,
	Регионы.Наименование КАК Регион
ИЗ
	Справочник.Фирмы КАК Фирмы
		ЛЕВОЕ СОЕДИНЕНИЕ Справочник.ЮрЛица КАК ЮрЛица
		ПО Фирмы.ЮрЛицо = ЮрЛица.Ссылка
		ЛЕВОЕ СОЕДИНЕНИЕ Справочник.Бренды КАК Бренды
		ПО Фирмы.Бренд = Бренды.Ссылка
		ЛЕВОЕ СОЕДИНЕНИЕ Справочник.Регионы КАК Регионы
		ПО Фирмы.Регион = Регионы.Ссылка
		ЛЕВОЕ СОЕДИНЕНИЕ Справочник.ЧастиРегионов КАК ЧастиРегионов
		ПО Фирмы.ЧастьРегиона = ЧастиРегионов.Ссылка		
		ЛЕВОЕ СОЕДИНЕНИЕ ВТ_Реквизиты КАК ДопРеквизиты
		ПО Фирмы.Ссылка = ДопРеквизиты.АптекаСсыкла
		ЛЕВОЕ СОЕДИНЕНИЕ Справочник.РабочиеМеста КАК РабочиеМеста
		ПО Фирмы.Ссылка = РабочиеМеста.Фирма.Ссылка
ГДЕ
	НЕ Фирмы.ПометкаУдаления
	И НЕ Фирмы.Закрыта
	И ((ВЫРАЗИТЬ(Фирмы.Наименование КАК СТРОКА(8))) = "Аптека №"
			ИЛИ (ВЫРАЗИТЬ(Фирмы.Наименование КАК СТРОКА(4))) = "АДБ№")
	И НЕ РабочиеМеста.Ссылка ЕСТЬ NULL
	И НЕ РабочиеМеста.ПометкаУдаления

УПОРЯДОЧИТЬ ПО
	НомерАптеки
ИТОГИ ПО
	АптекаНаименование
